{% extends 'layout.html' %}
{% block body %}
<style>
  .button {
      background-color: #4CAF50; /* Green */
      border: none;
      color: white;
      padding: 16px 32px;
      text-align: center;
      text-decoration: none;
      display: inline-block;
      font-size: 16px;
      margin: 4px 2px;
      -webkit-transition-duration: 0.4s; /* Safari */
      transition-duration: 0.4s;
      cursor: pointer;
  }

  .buttonpost {
      background-color: white;
      color: black;
      border: 2px solid #f44336;
  }

  .buttonpost:hover {
      background-color: #f44336;
      color: white;
  }

  .flex-container{
    display: flex;
    flex-flow: wrap;
    margin: 0 -5px;
  }
  .flex-container>* {
    flex: 0 0 33.3333%;
  }
  .allpics {
    max-width: 100%;
    height: 200px;
    margin: 0 3px;
  }
  a.button {
    -webkit-appearance: button;
    -moz-appearance: button;
    appearance: button;
    text-decoration: none;
    color: initial;
    position:absolute;
    top:50px; right:100px;
    font: bold 11px Arial;
    background-color: #EEEEEE;
    color: #333333;
    padding: 2px 6px 2px 6px;
    border-top: 1px solid #CCCCCC;
    border-right: 1px solid #333333;
    border-bottom: 1px solid #333333;
    border-left: 1px solid #CCCCCC;
  }
  .zoom {
    transition: transform .2s; /* Animation */
  }
  .zoom:hover {
    transform: scale(1.1); /* (150% zoom - Note: if the zoom is too large, it will go outside of the viewport) */
  }
</style>

<script type="text/javascript">

$(document).ready(() => {
  $('#filterButton').click(() => {
    const requestURL = '../locations/' + $('#locationBox').val().toLowerCase().split(' ').join('_');
    console.log(requestURL);
    console.log('making ajax request to:', requestURL);

    // From: http://learn.jquery.com/ajax/jquery-ajax-methods/
    // Using the core $.ajax() method since it's the most flexible.
    // ($.get() and $.getJSON() are nicer convenience functions)
    $.ajax({
      url: requestURL,
      type: 'GET',
      dataType : 'json', // this URL returns data in JSON format
      success: (data) => {
        console.log('You received some data!', data);
        console.log(data.length);
        if (data) {
          $('.zoom').remove();
          for (i = 0; i < data.length; ++i) {
            $("#pics").append('<div class="zoom"><a class="alllinks" href="/post/' + data[i].pid + '"><img class="allpics" src="' + data[i].img + '"></a></div>' );
          }
        } else {
          $("#pics").append('<span class="alllinks"> Invalid search man! </span>' );
        }
      },
    });
  });
/*
  $('#allUsersButton').click(() => {
    $.ajax({
      url: '../users/',
      type: 'GET',
      dataType : 'json',
      success: (data) => {
        console.log('You received some data!', data);
        $('#status').html('All users: ' + data);
      },
    });
  });
*/
  // define a generic Ajax error handler:
  // http://api.jquery.com/ajaxerror/
  $(document).ajaxError(() => {
    $('#status').html('Error: unknown ajaxError!');
    console.log('Error: unknown ajaxError!');
  });

  //$('.dropdown-toggle').dropdown();
});
</script>

<div class="row">
  <div class="col-10">
    <h1>Welcome to Here-n-There!</h1>
  </div>
  <div class="col-2">
    <a href="/newpost"><button class="button buttonpost">New Post</button></a>
  </div>
</div>
<hr/>
<div class="row">
  <div class="col-10">
    <iframe src="https://www.google.com/maps/embed?pb=!1m10!1m8!1m3!1d49921682.98558856!2d-1.219544210558942!3d40.20955851951437!3m2!1i1024!2i768!4f13.1!5e0!3m2!1sen!2sus!4v1524440040796 &key=AIzaSyAgZAsmAyovxVeCtAyXFUJ42hQxphw9YEY" width="100%" height="400" frameborder="0" style="border:0" allowfullscreen></iframe>
  </div>
  <div class="col-2">
    <div class="row text-center">
      <h2>Stats</h2>
    </div>
    <hr/>
    <div class="row text-center">
      <h2>Top Locations</h2>
    </div>
  </div>
</div>
<hr/>

<div class="row">
  <div class="col-12 gallery text-center">
    <h1>Gallery</h1>
    <input id="locationBox" type="text" size="20"/>
    <button id="filterButton">Look up Location!</button>
  </div>
</div>
<div class="row">
  <div class="col-12 gallery">
    <br>
    <br>
    <div id="pics" class="flex-container text-center">
      {% for post in posts %}
        <div class="zoom"><a class="alllinks" href="/post/{{post.pid}}"><img class="allpics" src="{{post.img}}"/></a></div>
      {% endfor %}
    </div>
  </div>
</div>
<div class="col-1"></div>
<div id="status"></div>
{% endblock %}
